#!/usr/bin/env ruby

require 'optparse'
require 'methadone'
require 'branch_sweeper.rb'

class App
  include Methadone::Main
  include Methadone::CLILogging

  main do |repository|
    BranchSweeper::Clean.new(repository, options['inactive-days'].to_i).run!
  end

  description 'Report branches that have not been active for the past year'

  options['inactive-days'] = 365
  on("-i DAYS", "--inactive-days", "How long the branch must be unchanged to be considered inactive")

  arg :repository, 'Repository to scan for inactive branches'

  version BranchSweeper::VERSION

  use_log_level_option toggle_debug_on_signal: 'USR1'

  go!
end
